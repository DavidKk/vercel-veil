# TODO.md - WebRTC 基础数据传输服务

> 目标：搭建一个最小可用的 WebRTC 点对点数据传输服务，专注于「稳定建立连接 + 数据传输」，后续可扩展为远程控制、多媒体传输、调试协作平台。

---

## 一、项目定位

### 核心目标

- 构建一个浏览器端 WebRTC P2P 数据通道
- 实现两个客户端之间的直接数据传输
- 服务端仅承担信令与房间管理，不参与数据中转
- 架构清晰，可平滑扩展后续功能

### 使用场景

- 调试数据传输
- 简单远程协助
- 设备信息同步
- 内网协作工具

---

## 二、功能需求（Functional Requirements）

### 2.1 基础连接能力

- [ ] 支持创建临时连接房间
- [ ] 自动生成唯一房间 ID
- [ ] 支持通过链接加入房间
- [ ] 支持通过输入连接码加入
- [ ] 房间仅允许 2 个客户端连接
- [ ] 显示当前连接状态
  - 未连接
  - 等待对方
  - 连接中
  - 已连接
  - 连接失败

---

### 2.2 数据传输能力

- [ ] 支持 WebRTC DataChannel 建立
- [ ] 支持文本数据发送
- [ ] 支持二进制数据传输
- [ ] 支持消息分片处理
- [ ] 提供数据发送测试面板
- [ ] 显示实时传输日志

---

### 2.3 信令机制

- [ ] 建立基础信令通道
- [ ] 实现 SDP Offer / Answer 交换
- [ ] 转发 ICE Candidate 信息
- [ ] 支持断线自动重试机制
- [ ] 信令状态可视化

---

### 2.4 房间管理

- [ ] 房间生命周期管理
- [ ] 超时自动销毁机制
- [ ] 房间最大存活时间设定
- [ ] 防止重复加入
- [ ] 显示房间基础信息

---

### 2.5 用户体验

- [ ] 清晰的连接指引
- [ ] 错误提示说明
- [ ] 网络异常提示
- [ ] 简约调试界面
- [ ] 移动端基础适配

---

## 三、技术需求（Technical Requirements）

### 3.1 前端技术栈

- Web 框架：Next.js
- UI 层：React
- 构建模式：App Router
- 客户端通信：WebRTC API

---

### 3.2 服务端技术

- 部署平台：Vercel
- 信令服务：HTTP + 短连接轮询 / WebSocket
- 状态存储：Vercel KV / Upstash
- 连接管理：房间映射机制

---

### 3.3 WebRTC 配置

- 仅使用 STUN 服务
- 不启用 TURN 中继
- 支持多浏览器兼容
- 支持 NAT 穿透检测
- 显示 ICE 状态反馈

---

### 3.4 网络与通信

- HTTPS 强制启用
- 信令加密传输
- 连接超时机制
- 网络状态检测

---

## 四、安全与限制

### 4.1 安全策略

- [ ] 房间 ID 随机不可预测
- [ ] 房间链接有效期
- [ ] 可选连接验证 PIN
- [ ] 防止重复连接攻击

---

### 4.2 约束限制

- 房间最大连接数：2
- 单次连接有效时长：可配置
- 不保证复杂网络连接成功率
- 无中继失败即断开

---

## 五、扩展预留（Future Features）

### 5.1 数据扩展

- [ ] 文件传输模块
- [ ] 图片预览传输
- [ ] 数据加密层

### 5.2 控制扩展

- [ ] 远程鼠标同步
- [ ] 键盘事件同步
- [ ] 远程命令执行

### 5.3 多媒体扩展

- [ ] 屏幕共享
- [ ] 音视频通话
- [ ] 实时录制

### 5.4 系统扩展

- [ ] 用户系统
- [ ] 历史记录
- [ ] 权限管理
- [ ] 多房间管理

---

## 六、基础页面结构建议

- 首页
  - 创建连接按钮
  - 加入连接输入框

- 房间页
  - 连接状态显示
  - 数据发送区
  - 调试日志区

- 设置页（预留）
  - 网络检测
  - STUN 配置

---

## 七、里程碑规划

### 阶段 1：基础连通（MVP）

- 建立房间
- 完成 SDP 协商
- 建立 WebRTC DataChannel
- 实现文本发送

### 阶段 2：稳定优化

- 连接状态监控
- 错误提示增强
- 重连机制

### 阶段 3：功能增强

- 文件传输
- 多端兼容优化

---

## 八、验收标准

- 双浏览器成功建立 P2P 连接
- 可稳定发送文本数据
- 网络中断可感知
- 页面反馈清晰

---

## 九、技术关键词

- WebRTC
- P2P
- DataChannel
- SDP
- ICE
- STUN
- Next.js
- Vercel
- KV
- 信令服务

---

> 本文档作为项目初期 TODO 列表，可根据实施情况逐步细化、拆分为任务。
